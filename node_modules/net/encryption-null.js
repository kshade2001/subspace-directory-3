/*
    Subspace Directory 3
    Copyright (C) 2015 Kingsley Masters
    Email: kingsley at flabbyfish.co.uk

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

//CONVERTED FROM CATID's MERV BOT (www.mervbot.com)


/*jslint node: true */
"use strict";

require("buffer");



var EncryptionNull = function (isContinuum) {
   this._flag = isContinuum ? 0x11:0x01;
};

EncryptionNull.prototype.login = function () {
    return new Buffer([0x00,0x01,0x00,0x00,0x00,0x00,this._flag,0x00]); 
};

EncryptionNull.prototype.reply = function (loginRequestBuffer) {
    var key = loginRequestBuffer.readUInt32LE(2);
    var loginReply = new Buffer([0x00,0x02,0x00,0x00,0x00,0x00]);
    loginReply.writeUInt32LE(key,2);
    return loginReply;
};

EncryptionNull.prototype.encrypt = function (buffer) {
    return buffer;
};

EncryptionNull.prototype.decrypt = function (buffer) {
    return buffer;
};


module.exports = EncryptionNull;